# üîß Configura√ß√£o Completa do Google MCP - Nova Conta Gmail

> **Guia completo para configurar todas as integra√ß√µes Google (Calendar, Drive, Gmail, Tasks) em uma nova conta caso a atual seja banida ou precise migrar.**

---

## üìã √çndice
1. [Pr√©-requisitos](#pr√©-requisitos)
2. [Parte 1: Criar Projeto no Google Cloud Console](#parte-1-criar-projeto-no-google-cloud-console)
3. [Parte 2: Habilitar APIs Necess√°rias](#parte-2-habilitar-apis-necess√°rias)
4. [Parte 3: Configurar OAuth 2.0](#parte-3-configurar-oauth-20)
5. [Parte 4: Criar Credenciais OAuth](#parte-4-criar-credenciais-oauth)
6. [Parte 5: Configurar o MCP no Cursor](#parte-5-configurar-o-mcp-no-cursor)
7. [Parte 6: Primeira Autentica√ß√£o](#parte-6-primeira-autentica√ß√£o)
8. [Parte 7: Verifica√ß√£o e Testes](#parte-7-verifica√ß√£o-e-testes)
9. [Solu√ß√£o de Problemas](#solu√ß√£o-de-problemas)

---

## üéØ Pr√©-requisitos

### Conta Google Nova ou Alternativa
- [ ] Conta Gmail v√°lida e ativa
- [ ] Acesso ao Google Cloud Console
- [ ] Navegador atualizado (Chrome, Firefox, Safari, Edge)

### Ferramentas Necess√°rias
- [ ] Cursor instalado
- [ ] Node.js (v18 ou superior) via NVM
- [ ] Bun instalado (para o google-mcp)

### Instala√ß√£o das Ferramentas

```bash
# Instalar NVM (se n√£o tiver)
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash

# Instalar Node.js
nvm install 22
nvm use 22

# Instalar Bun
curl -fsSL https://bun.sh/install | bash

# Instalar google-mcp globalmente
npm install -g google-mcp
```

---

## üöÄ Parte 1: Criar Projeto no Google Cloud Console

### 1.1 Acessar o Google Cloud Console

1. Navegue at√©: https://console.cloud.google.com/
2. Fa√ßa login com a nova conta Gmail
3. Aceite os Termos de Servi√ßo se solicitado

### 1.2 Criar Novo Projeto

1. No topo da p√°gina, clique no seletor de projetos (ao lado de "Google Cloud")
2. Clique em **"NOVO PROJETO"** (ou "NEW PROJECT")
3. Preencha os dados:
   - **Nome do Projeto**: `tattoo-calendar-mcp` (ou qualquer nome descritivo)
   - **Organiza√ß√£o**: Deixe como "Sem organiza√ß√£o" (No organization)
   - **Localiza√ß√£o**: Deixe em branco ou selecione conforme prefer√™ncia
4. Clique em **"CRIAR"** (ou "CREATE")
5. Aguarde alguns segundos at√© o projeto ser criado
6. Selecione o projeto rec√©m-criado no seletor de projetos

---

## üîå Parte 2: Habilitar APIs Necess√°rias

### 2.1 Acessar Biblioteca de APIs

1. No menu lateral esquerdo (‚ò∞), navegue at√©: **APIs e servi√ßos** > **Biblioteca**
2. Ou acesse diretamente: https://console.cloud.google.com/apis/library

### 2.2 Habilitar Google Calendar API

1. Na barra de pesquisa, digite: `Google Calendar API`
2. Clique no resultado **Google Calendar API**
3. Clique no bot√£o **"ATIVAR"** (ou "ENABLE")
4. Aguarde a ativa√ß√£o (alguns segundos)

### 2.3 Habilitar Google Drive API

1. Volte para a Biblioteca de APIs (bot√£o voltar ou link "Biblioteca")
2. Digite na busca: `Google Drive API`
3. Clique no resultado **Google Drive API**
4. Clique em **"ATIVAR"**

### 2.4 Habilitar Gmail API

1. Volte para a Biblioteca de APIs
2. Digite: `Gmail API`
3. Clique no resultado **Gmail API**
4. Clique em **"ATIVAR"**

### 2.5 Habilitar Google Tasks API

1. Volte para a Biblioteca de APIs
2. Digite: `Google Tasks API`
3. Clique no resultado **Tasks API**
4. Clique em **"ATIVAR"**

### 2.6 Habilitar Google People API (opcional, mas recomendado)

1. Volte para a Biblioteca de APIs
2. Digite: `Google People API`
3. Clique no resultado **People API**
4. Clique em **"ATIVAR"**

### ‚úÖ Checkpoint: APIs Habilitadas
Confirme que todas estas APIs est√£o ativas:
- ‚úÖ Google Calendar API
- ‚úÖ Google Drive API
- ‚úÖ Gmail API
- ‚úÖ Google Tasks API
- ‚úÖ Google People API (opcional)

---

## üîê Parte 3: Configurar OAuth 2.0

### 3.1 Configurar Tela de Consentimento OAuth

1. No menu lateral, v√° para: **APIs e servi√ßos** > **Tela de consentimento OAuth**
2. Ou acesse: https://console.cloud.google.com/apis/credentials/consent

### 3.2 Escolher Tipo de Usu√°rio

Voc√™ ver√° duas op√ß√µes:

**Op√ß√£o A: Interno (Internal)** - Apenas se tiver Google Workspace
- Dispon√≠vel apenas para contas Google Workspace
- Pule para "Op√ß√£o B" se n√£o tiver Workspace

**Op√ß√£o B: Externo (External)** - Recomendado para contas pessoais
- ‚úÖ Selecione **"Externo"** (External)
- Clique em **"CRIAR"** (CREATE)

### 3.3 Configurar Informa√ß√µes do App (P√°gina 1)

Preencha os campos obrigat√≥rios:

**Informa√ß√µes do aplicativo:**
- **Nome do aplicativo**: `Tattoo Calendar MCP` (ou seu nome preferido)
- **E-mail de suporte do usu√°rio**: Seu email Gmail
- **Logotipo do aplicativo**: (opcional, pode pular)

**Dom√≠nio do aplicativo:**
- **P√°gina inicial do aplicativo**: (opcional) ou `http://localhost:3001`
- **Pol√≠tica de Privacidade**: (opcional para teste)
- **Termos de Servi√ßo**: (opcional para teste)

**Dom√≠nios autorizados**: (deixe em branco por enquanto)

**Informa√ß√µes de contato do desenvolvedor:**
- **Endere√ßos de e-mail**: Seu email Gmail

Clique em **"SALVAR E CONTINUAR"**

### 3.4 Adicionar Escopos (P√°gina 2 - MAIS IMPORTANTE)

Esta √© a parte mais cr√≠tica - adicionar todos os escopos necess√°rios:

1. Clique em **"ADICIONAR OU REMOVER ESCOPOS"** (ADD OR REMOVE SCOPES)
2. Na janela que abrir, voc√™ pode:
   - **Op√ß√£o A**: Marcar os escopos manualmente da lista
   - **Op√ß√£o B**: Colar os escopos diretamente

**Cole estes escopos no campo "Atualizar escopos manualmente" (ou marque-os na lista):**

```
https://www.googleapis.com/auth/calendar
https://www.googleapis.com/auth/calendar.events
https://www.googleapis.com/auth/calendar.readonly
https://www.googleapis.com/auth/drive
https://www.googleapis.com/auth/drive.file
https://www.googleapis.com/auth/drive.readonly
https://www.googleapis.com/auth/gmail.modify
https://www.googleapis.com/auth/gmail.compose
https://www.googleapis.com/auth/gmail.send
https://www.googleapis.com/auth/gmail.readonly
https://www.googleapis.com/auth/gmail.labels
https://www.googleapis.com/auth/tasks
https://www.googleapis.com/auth/tasks.readonly
https://www.googleapis.com/auth/userinfo.profile
https://www.googleapis.com/auth/userinfo.email
```

3. Clique em **"ATUALIZAR"** (UPDATE)
4. Verifique se todos os 15 escopos aparecem na lista
5. Clique em **"SALVAR E CONTINUAR"**

### 3.5 Adicionar Usu√°rios de Teste (P√°gina 3)

Se voc√™ escolheu "Externo" na etapa 3.2:

1. Clique em **"+ ADICIONAR USU√ÅRIOS"** (ADD USERS)
2. Digite o email da conta Gmail que ser√° usada
3. Clique em **"ADICIONAR"**
4. **IMPORTANTE**: Adicione qualquer outro email que precise testar
5. Clique em **"SALVAR E CONTINUAR"**

### 3.6 Resumo (P√°gina 4)

1. Revise todas as configura√ß√µes
2. Clique em **"VOLTAR AO PAINEL"** (BACK TO DASHBOARD)

### ‚ö†Ô∏è Aviso Importante sobre Modo de Teste

Seu app ficar√° em **"Modo de Teste"** (Testing mode):
- ‚úÖ Pode ser usado por voc√™ e pelos usu√°rios de teste
- ‚úÖ N√£o expira (pode usar indefinidamente)
- ‚ö†Ô∏è Mostrar√° tela de aviso "App n√£o verificado" (normal, pode ignorar)
- üìù Limite de 100 usu√°rios de teste

Para uso pessoal, o modo de teste √© PERFEITO e n√£o precisa de verifica√ß√£o do Google.

---

## üîë Parte 4: Criar Credenciais OAuth

### 4.1 Criar ID do Cliente OAuth 2.0

1. No menu lateral, v√° para: **APIs e servi√ßos** > **Credenciais**
2. Ou acesse: https://console.cloud.google.com/apis/credentials
3. Clique em **"+ CRIAR CREDENCIAIS"** (CREATE CREDENTIALS)
4. Selecione **"ID do cliente OAuth 2.0"** (OAuth 2.0 Client ID)

### 4.2 Configurar Credenciais

**Tipo de aplicativo:**
- Selecione: **"Aplicativo para computador"** (Desktop app)

**Nome:**
- Digite: `Tattoo Calendar Desktop Client` (ou qualquer nome)

**URIs de redirecionamento autorizados:** (deixe em branco por padr√£o)

Clique em **"CRIAR"** (CREATE)

### 4.3 Salvar Credenciais

Uma janela aparecer√° com:
- **ID do cliente OAuth** (Client ID)
- **Chave secreta do cliente** (Client Secret)

**‚ö†Ô∏è MUITO IMPORTANTE - COPIE E SALVE ESTES DADOS AGORA:**

```
Client ID: 1234567890-abcdefghijklmnopqrstuvwxyz123456.apps.googleusercontent.com
Client Secret: GOCSPX-AbCdEfGhIjKlMnOpQrStUvWxYz
```

Voc√™ pode clicar em **"FAZER DOWNLOAD DO JSON"** para backup.

### 4.4 Verificar Configura√ß√£o de Redirecionamento

**IMPORTANTE**: O google-mcp usa `http://localhost:3001/oauth2callback` como URI de redirecionamento.

1. Na lista de credenciais, clique no nome da credencial que voc√™ acabou de criar
2. Role at√© **"URIs de redirecionamento autorizados"**
3. Se estiver vazio, adicione manualmente:
   - Clique em **"+ ADICIONAR URI"**
   - Cole: `http://localhost:3001/oauth2callback`
   - Clique em **"SALVAR"**

---

## ‚öôÔ∏è Parte 5: Configurar o MCP no Cursor

### 5.1 Localizar Arquivo de Configura√ß√£o

O arquivo de configura√ß√£o do Cursor est√° em:
- **macOS**: `~/.cursor/mcp.json` ou `/Users/SEU_USUARIO/.cursor/mcp.json`
- **Windows**: `%APPDATA%\Cursor\mcp.json`
- **Linux**: `~/.config/cursor/mcp.json`

### 5.2 Editar Configura√ß√£o do google-mcp

Abra o arquivo `mcp.json` e localize ou adicione a se√ß√£o `google-mcp`:

```json
{
  "mcpServers": {
    "google-mcp": {
      "command": "/Users/SEU_USUARIO/.nvm/versions/node/v22.15.0/bin/google-mcp",
      "args": [],
      "env": {
        "PATH": "/Users/SEU_USUARIO/.bun/bin:/usr/local/bin:/usr/bin:/bin",
        "GOOGLE_OAUTH_CLIENT_ID": "COLE_SEU_CLIENT_ID_AQUI",
        "GOOGLE_OAUTH_CLIENT_SECRET": "COLE_SEU_CLIENT_SECRET_AQUI",
        "GOOGLE_OAUTH_TOKEN_PATH": "/Users/SEU_USUARIO/Desktop/TATTOO_PHOTO_CALENDAR/agenda-hibrida-v2/tokens.json",
        "GOOGLE_CALENDAR_ID": "primary"
      },
      "disabled": false
    }
  }
}
```

### 5.3 Substituir Valores

**SUBSTITUA:**
1. `SEU_USUARIO` pelo seu nome de usu√°rio do sistema
2. `COLE_SEU_CLIENT_ID_AQUI` pelo Client ID copiado na Parte 4.3
3. `COLE_SEU_CLIENT_SECRET_AQUI` pelo Client Secret copiado na Parte 4.3
4. Ajuste o caminho do `GOOGLE_OAUTH_TOKEN_PATH` para onde voc√™ quer salvar os tokens

**Exemplo preenchido:**
```json
{
  "mcpServers": {
    "google-mcp": {
      "command": "/Users/luizlopes/.nvm/versions/node/v22.15.0/bin/google-mcp",
      "args": [],
      "env": {
        "PATH": "/Users/luizlopes/.bun/bin:/usr/local/bin:/usr/bin:/bin",
        "GOOGLE_OAUTH_CLIENT_ID": "1073557089506-5hk15al23til3ab4d5rs6c27eq6opdvp.apps.googleusercontent.com",
        "GOOGLE_OAUTH_CLIENT_SECRET": "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",
        "GOOGLE_OAUTH_TOKEN_PATH": "/Users/luizlopes/Desktop/TATTOO_PHOTO_CALENDAR/agenda-hibrida-v2/tokens.json",
        "GOOGLE_CALENDAR_ID": "primary"
      },
      "disabled": false
    }
  }
}
```

### 5.4 Verificar Caminho do google-mcp

Para encontrar o caminho correto do google-mcp:

```bash
which google-mcp
# Ou
command -v google-mcp
```

Use o caminho retornado no campo `command` da configura√ß√£o.

### 5.5 Salvar e Fechar

1. Salve o arquivo `mcp.json`
2. Feche o Cursor completamente
3. Reabra o Cursor

---

## üîì Parte 6: Primeira Autentica√ß√£o

### 6.1 Iniciar Autentica√ß√£o

1. Abra o Cursor
2. O servidor google-mcp tentar√° iniciar automaticamente
3. Um navegador ser√° aberto automaticamente para autentica√ß√£o OAuth

**Se n√£o abrir automaticamente**, voc√™ pode tentar manualmente:

```bash
# Terminal
cd /Users/SEU_USUARIO/Desktop/TATTOO_PHOTO_CALENDAR/agenda-hibrida-v2
google-mcp
```

### 6.2 Processo de Autentica√ß√£o no Navegador

**Passo 1: Escolher Conta**
- Selecione a conta Gmail que voc√™ configurou

**Passo 2: Tela de Aviso "App n√£o verificado"**
- ‚ö†Ô∏è Voc√™ ver√°: "Google hasn't verified this app"
- Isso √© NORMAL para apps em modo de teste
- Clique em **"Advanced"** (Avan√ßado)
- Clique em **"Go to [Nome do App] (unsafe)"** - N√ÉO SE PREOCUPE, √© seu pr√≥prio app!

**Passo 3: Permiss√µes**
Voc√™ ver√° uma lista de permiss√µes solicitadas:
- ‚úÖ Ver, editar, criar e excluir todos os seus calend√°rios do Google Agenda
- ‚úÖ Ver e fazer download de todos os seus arquivos do Google Drive
- ‚úÖ Ler, redigir, enviar e excluir permanentemente todos os seus e-mails do Gmail
- ‚úÖ Ver, editar e excluir permanentemente suas tarefas
- ‚úÖ Ver suas informa√ß√µes pessoais b√°sicas

**Clique em "Allow" (Permitir) ou "Continue" (Continuar)**

**Passo 4: Confirma√ß√£o**
- Voc√™ ver√° uma mensagem de sucesso
- A p√°gina pode dizer "Authentication successful, you can close this window"
- Feche a janela do navegador

### 6.3 Verificar Tokens Salvos

Verifique se o arquivo de tokens foi criado:

```bash
ls -la /Users/SEU_USUARIO/Desktop/TATTOO_PHOTO_CALENDAR/agenda-hibrida-v2/tokens.json
cat /Users/SEU_USUARIO/Desktop/TATTOO_PHOTO_CALENDAR/agenda-hibrida-v2/tokens.json
```

O arquivo deve conter um JSON com `access_token`, `refresh_token`, etc.

---

## ‚úÖ Parte 7: Verifica√ß√£o e Testes

### 7.1 Verificar Status do MCP no Cursor

1. No Cursor, verifique se o √≠cone do google-mcp est√° verde
2. Deveria mostrar "35 tools enabled"

### 7.2 Testar Cada API

No Cursor, voc√™ pode testar cada funcionalidade:

**Teste 1: Google Calendar**
```
Liste meus calend√°rios
```

**Teste 2: Google Drive**
```
Liste os primeiros 5 arquivos do meu Google Drive
```

**Teste 3: Gmail**
```
Liste minhas labels do Gmail
```

**Teste 4: Google Tasks**
```
Liste minhas listas de tarefas
```

### 7.3 Checklist de Verifica√ß√£o

- [ ] google-mcp aparece como ativo no Cursor (verde)
- [ ] 35 ferramentas est√£o habilitadas
- [ ] Arquivo tokens.json foi criado
- [ ] Google Calendar responde corretamente
- [ ] Google Drive responde corretamente
- [ ] Gmail responde corretamente (sem erro de scopes)
- [ ] Google Tasks responde corretamente (sem erro de scopes)

---

## üîß Solu√ß√£o de Problemas

### Problema 1: "Authentication failed: Neither OAuth nor Service Account..."

**Causa**: Vari√°veis de ambiente incorretas no mcp.json

**Solu√ß√£o**:
- Verifique se usou `GOOGLE_OAUTH_CLIENT_ID` (n√£o `GOOGLE_CLIENT_ID`)
- Verifique se usou `GOOGLE_OAUTH_CLIENT_SECRET` (n√£o `GOOGLE_CLIENT_SECRET`)
- Verifique se usou `GOOGLE_OAUTH_TOKEN_PATH` (n√£o `GOOGLE_APPLICATION_CREDENTIALS`)

### Problema 2: "Request had insufficient authentication scopes"

**Causa**: Faltam escopos na configura√ß√£o OAuth

**Solu√ß√£o**:
1. Volte para Google Cloud Console > Tela de consentimento OAuth
2. Edite os escopos e adicione todos os 15 escopos listados na Parte 3.4
3. Delete o arquivo `tokens.json`
4. Reinicie o Cursor
5. Fa√ßa a autentica√ß√£o novamente

### Problema 3: "Failed to start server. Is port 3001 in use?"

**Causa**: Porta 3001 est√° em uso ou bloqueada

**Solu√ß√£o A - Verificar processo usando a porta:**
```bash
# macOS/Linux
lsof -i :3001
# Matar processo se encontrado
kill -9 PID_DO_PROCESSO
```

**Solu√ß√£o B - Usar porta alternativa:**
Modifique temporariamente a configura√ß√£o do google-mcp para usar outra porta (requer modifica√ß√£o avan√ßada).

### Problema 4: "App n√£o verificado" n√£o mostra op√ß√£o "Advanced"

**Causa**: Seu email n√£o est√° na lista de usu√°rios de teste

**Solu√ß√£o**:
1. Volte para Google Cloud Console > Tela de consentimento OAuth
2. Clique em "Usu√°rios de teste"
3. Adicione seu email Gmail
4. Tente autenticar novamente

### Problema 5: Token expirado

**Causa**: Access token expirou (dura apenas 1 hora)

**Solu√ß√£o**: O refresh token √© autom√°tico. Se n√£o funcionar:
```bash
# Delete os tokens e re-autentique
rm /caminho/para/tokens.json
# Reinicie o Cursor
```

### Problema 6: "Client ID not found"

**Causa**: Client ID ou Secret incorretos

**Solu√ß√£o**:
1. Volte para Google Cloud Console > APIs e servi√ßos > Credenciais
2. Clique na credencial que voc√™ criou
3. Copie novamente o Client ID e Secret
4. Atualize o mcp.json
5. Delete tokens.json
6. Reinicie o Cursor

---

## üì± Informa√ß√µes Adicionais

### Limites da API Google

**Google Calendar API:**
- 1.000.000 requisi√ß√µes por dia
- 10 requisi√ß√µes por segundo

**Google Drive API:**
- 1.000.000.000 requisi√ß√µes por dia
- 1.000 requisi√ß√µes por 100 segundos por usu√°rio

**Gmail API:**
- 1.000.000.000 requisi√ß√µes por dia
- 250 requisi√ß√µes por segundo por usu√°rio

**Google Tasks API:**
- 50.000 requisi√ß√µes por dia
- 600 requisi√ß√µes por minuto

Para uso pessoal, esses limites s√£o mais que suficientes.

### Seguran√ßa dos Tokens

**‚ö†Ô∏è IMPORTANTE:**
- Nunca compartilhe seu `tokens.json`
- Nunca fa√ßa commit do `tokens.json` no Git
- Adicione `tokens.json` ao `.gitignore`
- Nunca exponha seu Client Secret publicamente

**Adicionar ao .gitignore:**
```bash
echo "tokens.json" >> .gitignore
echo "google-credentials.json" >> .gitignore
```

### Revogar Acesso

Se precisar revogar o acesso do app:

1. Acesse: https://myaccount.google.com/permissions
2. Encontre "Tattoo Calendar MCP" (ou nome que voc√™ deu)
3. Clique em "Remove Access"
4. Delete o arquivo `tokens.json`

### Backup das Credenciais

**Salve em local seguro:**
1. Client ID
2. Client Secret
3. ID do Projeto Google Cloud
4. Lista de APIs habilitadas
5. Lista de escopos configurados

**Sugest√£o**: Use um gerenciador de senhas como 1Password, LastPass, Bitwarden, etc.

---

## üéØ Resumo R√°pido (TL;DR)

Para configurar rapidamente em uma nova conta:

1. **Google Cloud Console** ‚Üí Criar projeto
2. **Habilitar APIs**: Calendar, Drive, Gmail, Tasks, People
3. **Tela de consentimento OAuth** ‚Üí Tipo "Externo" ‚Üí Adicionar 15 escopos ‚Üí Adicionar usu√°rios de teste
4. **Criar Credenciais OAuth** ‚Üí Tipo "Desktop App" ‚Üí Copiar Client ID e Secret
5. **Editar `~/.cursor/mcp.json`** ‚Üí Colar Client ID, Client Secret, definir path dos tokens
6. **Reiniciar Cursor** ‚Üí Autenticar no navegador ‚Üí Aceitar todas as permiss√µes
7. **Testar** ‚Üí Verificar 35 tools habilitadas e testar cada API

**Tempo estimado: 20-30 minutos**

---

## üìû Suporte e Recursos

### Documenta√ß√£o Oficial
- Google Cloud Console: https://console.cloud.google.com/
- Google MCP GitHub: https://github.com/vakharwalad23/google-mcp
- OAuth 2.0 Docs: https://developers.google.com/identity/protocols/oauth2

### URLs √öteis
- Google Cloud Console: https://console.cloud.google.com/
- API Library: https://console.cloud.google.com/apis/library
- Credentials: https://console.cloud.google.com/apis/credentials
- OAuth Consent: https://console.cloud.google.com/apis/credentials/consent
- My Account Permissions: https://myaccount.google.com/permissions

---

## üìù Notas Finais

Este guia foi criado para a configura√ß√£o do projeto **Tattoo Calendar** com integra√ß√£o completa ao Google MCP.

**Data de cria√ß√£o**: 27 de outubro de 2025
**Vers√£o**: 1.0
**Conta atual**: photocalendar25@gmail.com
**Projeto atual**: tattoo-calendar-mcp

Se a conta for banida, siga este guia passo a passo com uma nova conta Gmail para recriar toda a configura√ß√£o em aproximadamente 20-30 minutos.

**Boa sorte! üöÄ**

